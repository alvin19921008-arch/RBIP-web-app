

I am curious of your phase 1 non-floating PCA step K to T for “Handle remaining non-floating slots”. Because at J; supposedly ALL FTE (be it his/her FTE=1.0 or  (>0 & <1)) for ALL non-floating PCA should ONLY assign to the non-floating PCA’s designated team. It should not assign the non-floating PCA to other teams. Indeed there would be a scenario that when a given team has multiple therapists on leave making PT/team lesser -> making PCA/team lesser as well. Even though for a given team when PCA/team <1, algorithm should still hard assign all his/her FTE-remaining of non-floating PCA to the designated team. Then it is ALLOWED that the “assigned PCA” > PCA/team in this situation. 
Also I don’t see in the current logic of phase 1, when the non-floating PCA FTE /= 1 & /= 0 for his/her specific slot_notA/v, algorithm should find from floating PCA (who is on duty that day + with that specific non-floating PCA’s slot_notA/V a/v)+ not on special program for that specific non-floating PCA’s slot_notA/V) to sub this missing FTE at this missing slot_notA/v. In this scenario, the exit should be until all non-floating PCA’s slot_notA/V are being substituted from floating PCA. 
Also in current phase 1, you can add a logic that a non-floating PCA can be called by phase 2 under an edge condition (which is already now in place of existing code in phase 2). It is when a special program of a given day, all the floating PCA with this special program property is not A/V (be it not on duty whole day OR not A/V for this specific special program_slots on that given day), then algorithm is allowed to find the next NON-floating PCA with this specific special program_slots (this non-floating PCA is on duty that day; + for “this specific special program_slots” this non-floating PCA’s respective slot is also A/V(on duty-regardless if it has already been assigned to desginated team))to sub for the special program. Then after non-floating PCA is being called the sub the slot of the special program; algorithm would loop back to find OTHER floating PCA to sub this missing slot. 


Please ask question if need clarification. 


I just want to further clarify:
e (averagePCA/team) is displayed in Block 6 (yes) and it is used for PCA allocation for *pendingPCAFTE/team*, and this value would be rounded to nearest 0.25 when matching with PCA allocation. 



- a:(total no. of bed/a GIVEN TEAM) = (no. Of bed per A GIVEN THERAPIST)× (sum of therapist-base FTE of THAT TEAM)
 Where b: (no. Of bed/ A GIVEN THERAPIST) = (total beds across ALL TEAMS) / (sum of therapist-base FTE of ALL TEAMS)

- c: (total no. of bed/PCA) = (total beds across all teams) / (sum of fte_pca)
- e: (average PCA/ a given team) = a: (total no. Of bed / a given TEAM) / c: (total no. of bed/PCA)
- and e: is the value you would display in block 6 (just like existing now), and this value is used to PCA allocation like existing logic, with rounding to nearest 0.25
- and a is to compute the no. Of reliving bed against that's team designated ward bed counts in block 5
=========

This is in fact another great lesson from the last debug. Since the step-wise workflow would rely on this smooth processing of the LATEST staffoverrides. Now the issue is staffoverrides did register what the user’s manual edit in each step; but the therapist allocation/ PCA allocation or any other allocation function may not receive call to update; therefore the UI finally show the old data. Also useffect also triggers but the interim step seems missing. 
Can you see ways to optimize the existing code or to write project rule that when continue to develop the PCA allocation; the code it developed can respect this workflow logic


